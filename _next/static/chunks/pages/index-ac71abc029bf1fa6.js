(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(7279)}])},7279:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var r=n(7568),a=n(603),o=n(4051),i=n.n(o),s=n(5893),c=n(7294),l=n(5861),d=n(6886),u="22.7.406",h=n(6887),f=n(8396),x=n(7357),p={500:["#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688"],200:["#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#9fa8da","#90caf9","#81d4fa","80deea","#80cbc4"]},g={800:["#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#c62828","#ad1457","#6a1b9a","#4527a0","#283593","#1565c0","#0277bd","#00838f","#00695c"]},b=n(8100),m=n(8909),Z=function(e){var t=e.month,n=e.year,o=(0,b.D3)().getAccessTokenSilently,d=((0,f.Z)("(min-width:600px)"),(0,a.Z)(c.useState([["From","To","kr",{type:"string",role:"tooltip"}],["A","B",10,"foo"]]),2)),u=d[0],Z=d[1];c.useEffect((function(){(0,r.Z)(i().mark((function e(){var r,a,s,c,l;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("use effect called:",t,n),e.prev=1,e.next=4,o({audience:"https://api.malt.no/budget",scope:"read:streams"});case 4:return r=e.sent,a="".concat("https://api.malt.no","/budget/streams/").concat(n,"/").concat(parseInt(t)+1),e.next=8,fetch(a,{headers:{Authorization:"Bearer ".concat(r)}});case 8:return s=e.sent,e.next=11,s.json();case 11:c=e.sent,l=[["From","To","Kr ",{type:"string",role:"tooltip"}]],c.values.forEach((function(e){l.push([e[0],e[1],e[2],'<div style="white-space: nowrap; padding: 8px;"><strong>'.concat(e[1],"</strong><br/>kr ").concat(e[2].toFixed(2),"</div>")])})),Z(l),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,17]])})))()}),[t,n,o]);var j=new Date(parseInt(n),parseInt(t),12);return(0,s.jsxs)(x.Z,{children:[(0,s.jsx)(l.Z,{variant:"h5",children:j.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,s.jsx)(h.ZP,{chartType:"Sankey",width:"calc(100vw - 48px)",height:"calc(100vh - 265px)",style:{maxWidth:"".concat(m.r.breakpoints.values.xl-48,"px"),maxHeight:"".concat(m.r.breakpoints.values.xl*(9/16),"px")},options:{sankey:{iterations:256,link:{colors:p[200],colorMode:"gradient"},node:{colors:g[800],width:40,label:{color:"#444",fontName:"Roboto",fontSize:12}}},tooltip:{isHtml:!0,textStyle:{fontSize:12}}},data:u})]})},j=n(3321),v=n(2293),y=n(3156),w=n(155),k=n(3946),S=n(9661),C=n(8444),T=n(2224),_=n(7720),P=n(8885),z=n(326),M=n(9029),W=function(){var e=(0,b.D3)(),t=e.loginWithRedirect,n=e.logout,r=e.isAuthenticated,o=e.user,i=function(){r?n({returnTo:"https://budget.malt.no",client_id:"BoqWrpecEONM0NjjSTYjTWKcUa74kI7h"}):t({connection:"google-oauth2"})},d=(0,a.Z)(c.useState(null),2),u=d[0],h=d[1],f=function(e){return h(e.currentTarget)},x=function(){return h(null)};return(0,s.jsx)(v.Z,{elevation:1,position:"static",sx:{backgroundColor:m.r.palette.primary.main,background:"linear-gradient(90deg, ".concat(m.r.palette.primary.main," 20%, #4db6ac 80%)")},children:(0,s.jsx)(y.Z,{maxWidth:"xl",disableGutters:!0,children:(0,s.jsxs)(w.Z,{children:[(0,s.jsx)(k.Z,{edge:"start",size:"large",color:"inherit","aria-label":"menu",sx:{mr:2,paddingLeft:"16px"},children:(0,s.jsx)(z.Z,{})}),(0,s.jsx)(l.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"budget.malt.no"}),(0,s.jsx)(j.Z,{color:"inherit",onClick:i,children:r?"Logout":"Login"}),(0,s.jsx)(S.Z,{onClick:f,color:"inherit",src:"undefined"===typeof o?"":o.picture,alt:"undefined"===typeof o?"Unauthorized user":o.name,sx:{border:"3.5px solid white",padding:0}}),(0,s.jsxs)(C.Z,{anchorEl:u,open:Boolean(u),onClose:x,onClick:x,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&:before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,s.jsxs)(T.Z,{children:[(0,s.jsx)(S.Z,{onClick:f,color:"inherit",src:"undefined"===typeof o?"":o.picture,alt:"undefined"===typeof o?"Unauthorized user":o.name,sx:{border:"3.5px solid white"}})," ","undefined"===typeof o?"Unauthorized user":o.name]}),(0,s.jsx)(_.Z,{}),(0,s.jsxs)(T.Z,{children:[(0,s.jsx)(P.Z,{children:(0,s.jsx)(M.Z,{fontSize:"small"})}),"Logout"]})]})]})})})},E=n(4054),I=n(3841),N=n(4917),A=function(e){var t=e.onYearChange,n=e.onMonthChange,r=e.years,o=new Date,i="January February March April May June July August September October November December".split(" ").map((function(e,t){return[e,t]})),l=function(e,t){return e.filter((function(e){return t<o.getFullYear()||e[1]<=o.getMonth()}))},u=(0,a.Z)(c.useState(o.getFullYear().toString()),2),h=u[0],f=u[1],x=(0,a.Z)(c.useState(l(i,parseInt(h,10))),2),p=x[0],g=x[1],b=(0,a.Z)(c.useState(o.getMonth().toString()),2),m=b[0],Z=b[1];return(0,s.jsxs)(d.ZP,{container:!0,paddingTop:3,paddingBottom:3,spacing:3,direction:"row",justifyContent:"flex-start",children:[(0,s.jsx)(d.ZP,{item:!0,xs:6,sm:3,md:2,sx:{minWidth:"288px"},children:(0,s.jsxs)(E.Z,{variant:"standard",sx:{width:"100%"},children:[(0,s.jsx)(I.Z,{id:"budget-year-label",children:"Year"}),(0,s.jsx)(N.Z,{labelId:"budget-year-label",id:"budget-year-select",value:h,onChange:function(e){f(e.target.value),g(l(i,parseInt(e.target.value))),"function"===typeof t&&t(e.target.value)},children:r.map((function(e){return(0,s.jsx)(T.Z,{value:e,children:e},e)}))})]})}),(0,s.jsx)(d.ZP,{item:!0,xs:6,sm:3,md:2,sx:{minWidth:"288px",maxWidth:"343px"},children:(0,s.jsxs)(E.Z,{variant:"standard",sx:{width:"100%"},children:[(0,s.jsx)(I.Z,{id:"budget-month-label",children:"Month"}),(0,s.jsx)(N.Z,{labelId:"budget-month-label",id:"budget-month-select",value:m,onChange:function(e){Z(e.target.value),"function"===typeof n&&n(e.target.value)},children:p.map((function(e){return(0,s.jsx)(T.Z,{value:e[1],children:e[0]},e[0])}))})]})})]})},D=function(){var e=new Date,t=(0,b.D3)().isAuthenticated,n=(0,a.Z)(c.useState(e.getFullYear().toString()),2),o=n[0],h=n[1],p=(0,a.Z)(c.useState(e.getMonth().toString()),2),g=p[0],j=p[1],v=(0,a.Z)(c.useState([]),2),w=v[0],k=v[1],S=function(){var e=(0,r.Z)(i().mark((function e(){var t,n,r;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("https://api.malt.no","/budget/years"),e.prev=1,e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,console.log("years data:",r),e.abrupt("return",r.years);case 12:return e.prev=12,e.t0=e.catch(1),console.error("Got error fetching years:",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();c.useEffect((function(){S().then((function(e){return k(e)}))}),[]);var C=(0,f.Z)("(min-width:600px)");return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(W,{}),(0,s.jsxs)(d.ZP,{container:!0,direction:"row",spacing:0,justifyContent:"flex-start",alignItems:"flex-start",position:"absolute",height:"calc(100vh - 64px)",children:[(0,s.jsx)(d.ZP,{item:!0,xs:12,flexGrow:20,flexBasis:"90%",children:(0,s.jsx)(y.Z,{maxWidth:"xl",sx:{},children:(0,s.jsx)(x.Z,{sx:{paddingTop:2,height:"100%"},children:t&&(0,s.jsx)(Z,{month:g,year:o})})})}),(0,s.jsx)(d.ZP,{item:!0,xs:12,flexShrink:0,children:(0,s.jsx)(y.Z,{maxWidth:"xl",children:(0,s.jsx)(A,{years:w,onYearChange:function(e){return h(e)},onMonthChange:function(e){return j(e)}})})}),function(){if(C)return(0,s.jsx)(d.ZP,{item:!0,xs:12,flexGrow:4,flexShrink:0,sx:{backgroundColor:m.r.palette.grey[200],borderTop:"1px solid ".concat(m.r.palette.grey[300])},children:(0,s.jsx)(y.Z,{maxWidth:"xl",children:(0,s.jsx)(x.Z,{sx:{padding:"16px 0px"},children:(0,s.jsxs)(l.Z,{variant:"caption",children:["budget sankey - v",u]})})})})}()]})]})}}},function(e){e.O(0,[696,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);