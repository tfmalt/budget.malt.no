(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(9169)}])},7592:function(e,t,n){"use strict";n.d(t,{f:function(){return g}});var r=n(7568),a=n(603),i=n(4051),o=n.n(i),c=n(5893),s=n(7294),l=n(6887),d=n(8396),u=n(7357),h=n(5861),f={500:["#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688"],200:["#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#9fa8da","#90caf9","#81d4fa","80deea","#80cbc4"]},x={800:["#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#c62828","#ad1457","#6a1b9a","#4527a0","#283593","#1565c0","#0277bd","#00838f","#00695c"]},p=n(8100),g=function(e){var t=e.month,n=e.year,i=e.width,g=e.height,m=e.maxWidth,b=e.maxHeight,j=(0,p.D3)().getAccessTokenSilently,v=((0,d.Z)("(min-width:600px)"),(0,a.Z)(s.useState([["From","To","kr",{type:"string",role:"tooltip"}],["A","B",10,"foo"]]),2)),Z=v[0],y=v[1];s.useEffect((function(){(0,r.Z)(o().mark((function e(){var r,a,i,c,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("use effect called:",t,n),e.prev=1,e.next=4,j({audience:"https://api.malt.no/budget",scope:"read:streams"});case 4:return r=e.sent,a="".concat("https://api.malt.no","/budget/streams/").concat(n,"/").concat(parseInt(t)+1),e.next=8,fetch(a,{headers:{Authorization:"Bearer ".concat(r)}});case 8:return i=e.sent,e.next=11,i.json();case 11:c=e.sent,s=[["From","To","Kr ",{type:"string",role:"tooltip"}]],c.values.forEach((function(e){s.push([e[0],e[1],e[2],'<div style="white-space: nowrap; padding: 8px;"><strong>'.concat(e[1],"</strong><br/>kr ").concat(e[2].toFixed(2),"</div>")])})),y(s),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(1),console.error(e.t0);case 20:case"end":return e.stop()}}),e,null,[[1,17]])})))()}),[t,n,j]);var w=new Date(parseInt(n),parseInt(t),12);return(0,c.jsxs)(u.Z,{children:[(0,c.jsx)(h.Z,{variant:"h5",children:w.toLocaleDateString("en-US",{month:"long",year:"numeric"})}),(0,c.jsx)(l.ZP,{chartType:"Sankey",style:{width:i||400,height:g||400,maxWidth:m||"100%",maxHeight:b||"calc(100vw - 128px)"},options:{sankey:{iterations:256,link:{colors:f[200],colorMode:"gradient"},node:{colors:x[800],width:40,label:{color:"#444",fontName:"Roboto",fontSize:12}}},tooltip:{isHtml:!0,textStyle:{fontSize:12}}},data:Z})]})}},9169:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return E}});var r=n(7568),a=n(603),i=n(4051),o=n.n(i),c=n(5893),s=n(7294),l=n(5861),d=n(6886),u="22.7.408",h=n(7592),f=n(3321),x=n(2293),p=n(3156),g=n(155),m=n(3946),b=n(9661),j=n(8444),v=n(2224),Z=n(7720),y=n(8885),w=n(326),k=n(9029),S=n(8100),C=n(8909),W=function(){var e=(0,S.D3)(),t=e.loginWithRedirect,n=e.logout,r=e.isAuthenticated,i=e.user,o=function(){r?n({returnTo:"https://budget.malt.no",client_id:"BoqWrpecEONM0NjjSTYjTWKcUa74kI7h"}):t({connection:"google-oauth2"})},d=(0,a.Z)(s.useState(null),2),u=d[0],h=d[1],W=function(e){return h(e.currentTarget)},P=function(){return h(null)};return(0,c.jsx)(x.Z,{elevation:1,position:"static",sx:{backgroundColor:C.r.palette.primary.main,background:"linear-gradient(90deg, ".concat(C.r.palette.primary.main," 20%, #4db6ac 80%)")},children:(0,c.jsx)(p.Z,{maxWidth:"xl",disableGutters:!0,children:(0,c.jsxs)(g.Z,{children:[(0,c.jsx)(m.Z,{edge:"start",size:"large",color:"inherit","aria-label":"menu",sx:{mr:2,paddingLeft:"16px"},children:(0,c.jsx)(w.Z,{})}),(0,c.jsx)(l.Z,{variant:"h6",component:"div",sx:{flexGrow:1},children:"budget.malt.no"}),(0,c.jsx)(f.Z,{color:"inherit",onClick:o,children:r?"Log out":"Log in"}),(0,c.jsx)(b.Z,{onClick:W,color:"inherit",src:"undefined"===typeof i?"":i.picture,alt:"undefined"===typeof i?"Unauthorized user":i.name,sx:{border:"3.5px solid white",padding:0}}),(0,c.jsxs)(j.Z,{anchorEl:u,open:Boolean(u),onClose:P,onClick:P,PaperProps:{elevation:0,sx:{overflow:"visible",filter:"drop-shadow(0px 2px 8px rgba(0,0,0,0.32))",mt:1.5,"& .MuiAvatar-root":{width:32,height:32,ml:-.5,mr:1},"&:before":{content:'""',display:"block",position:"absolute",top:0,right:14,width:10,height:10,bgcolor:"background.paper",transform:"translateY(-50%) rotate(45deg)",zIndex:0}}},transformOrigin:{horizontal:"right",vertical:"top"},anchorOrigin:{horizontal:"right",vertical:"bottom"},children:[(0,c.jsxs)(v.Z,{children:[(0,c.jsx)(b.Z,{onClick:W,color:"inherit",src:"undefined"===typeof i?"":i.picture,alt:"undefined"===typeof i?"Unauthorized user":i.name,sx:{border:"3.5px solid white"}})," ","undefined"===typeof i?"Unauthorized user":i.name]}),(0,c.jsx)(Z.Z,{}),(0,c.jsxs)(v.Z,{children:[(0,c.jsx)(y.Z,{children:(0,c.jsx)(k.Z,{fontSize:"small"})}),"Logout"]})]})]})})})},P=n(4054),T=n(3841),_=n(4917),z=function(e){var t=e.onYearChange,n=e.onMonthChange,r=e.years,i=new Date,o="January February March April May June July August September October November December".split(" ").map((function(e,t){return[e,t]})),l=function(e,t){return e.filter((function(e){return t<i.getFullYear()||e[1]<=i.getMonth()}))},u=(0,a.Z)(s.useState(i.getFullYear().toString()),2),h=u[0],f=u[1],x=(0,a.Z)(s.useState(l(o,parseInt(h,10))),2),p=x[0],g=x[1],m=(0,a.Z)(s.useState(i.getMonth().toString()),2),b=m[0],j=m[1];return(0,c.jsxs)(d.ZP,{container:!0,paddingTop:2,paddingBottom:2,spacing:3,direction:"row",justifyContent:"flex-start",children:[(0,c.jsx)(d.ZP,{item:!0,xs:6,sm:3,md:2,sx:{minWidth:"288px"},children:(0,c.jsxs)(P.Z,{variant:"standard",sx:{width:"100%"},children:[(0,c.jsx)(T.Z,{id:"budget-year-label",children:"Year"}),(0,c.jsx)(_.Z,{labelId:"budget-year-label",id:"budget-year-select",value:h,onChange:function(e){f(e.target.value),g(l(o,parseInt(e.target.value))),"function"===typeof t&&t(e.target.value)},children:r.map((function(e){return(0,c.jsx)(v.Z,{value:e,children:e},e)}))})]})}),(0,c.jsx)(d.ZP,{item:!0,xs:6,sm:3,md:2,sx:{minWidth:"288px",maxWidth:"343px"},children:(0,c.jsxs)(P.Z,{variant:"standard",sx:{width:"100%"},children:[(0,c.jsx)(T.Z,{id:"budget-month-label",children:"Month"}),(0,c.jsx)(_.Z,{labelId:"budget-month-label",id:"budget-month-select",value:b,onChange:function(e){j(e.target.value),"function"===typeof n&&n(e.target.value)},children:p.map((function(e){return(0,c.jsx)(v.Z,{value:e[1],children:e[0]},e[0])}))})]})})]})},I=n(8396),M=n(7357),E=function(){var e=new Date,t=(0,S.D3)(),n=t.isAuthenticated,i=t.loginWithRedirect,x=(0,a.Z)(s.useState(e.getFullYear().toString()),2),g=x[0],m=x[1],b=(0,a.Z)(s.useState(e.getMonth().toString()),2),j=b[0],v=b[1],Z=(0,a.Z)(s.useState([]),2),y=Z[0],w=Z[1],k=function(){var e=(0,r.Z)(o().mark((function e(){var t,n,r;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="".concat("https://api.malt.no","/budget/years"),e.prev=1,e.next=4,fetch(t);case 4:return n=e.sent,e.next=7,n.json();case 7:return r=e.sent,console.log("years data:",r),e.abrupt("return",r.years);case 12:return e.prev=12,e.t0=e.catch(1),console.error("Got error fetching years:",e.t0),e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(){return e.apply(this,arguments)}}();s.useEffect((function(){k().then((function(e){return w(e)}))}),[]);var P=function(e){return m(e)},T=function(e){return v(e)},_=(0,I.Z)("(min-width:600px)"),E=function(){i({connection:"google-oauth2"})};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(W,{}),n?(0,c.jsxs)(d.ZP,{container:!0,direction:"row",spacing:0,sx:{justifyContent:"flex-start",alignItems:"flex-start",height:"calc(100vh - 121px)"},children:[(0,c.jsx)(d.ZP,{item:!0,xs:12,flexGrow:20,children:(0,c.jsx)(p.Z,{maxWidth:"xl",sx:{},children:(0,c.jsx)(M.Z,{sx:{paddingTop:2,height:"100%"},children:(0,c.jsx)(h.f,{month:j,year:g,width:"calc(100vw - 48px)",height:"calc(100vh - 265px)",maxWidth:"".concat(C.r.breakpoints.values.xl-48,"px"),maxHeight:"".concat(C.r.breakpoints.values.xl*(9/16),"px")})})})}),(0,c.jsx)(d.ZP,{item:!0,xs:12,flexShrink:1,children:(0,c.jsx)(p.Z,{maxWidth:"xl",children:(0,c.jsx)(z,{years:y,onYearChange:P,onMonthChange:T})})})]}):(0,c.jsx)(d.ZP,{container:!0,sx:{justifyContent:"center",alignItems:"center",height:"calc(100vh - 121px)"},children:(0,c.jsx)(d.ZP,{item:!0,sx:{padding:2},children:(0,c.jsx)(f.Z,{sx:{backgroundColor:C.r.palette.primary.main,background:"linear-gradient(90deg, ".concat(C.r.palette.primary.main," 20%, #4db6ac 80%)")},variant:"contained",onClick:E,children:"Sign in with Google"})})}),function(){if(_)return(0,c.jsx)("footer",{style:{backgroundColor:C.r.palette.grey[200],borderTop:"1px solid ".concat(C.r.palette.grey[300])},children:(0,c.jsx)(p.Z,{maxWidth:"xl",children:(0,c.jsx)(M.Z,{sx:{padding:"16px 0px"},children:(0,c.jsxs)(l.Z,{variant:"caption",children:["budget sankey - v",u]})})})})}()]})}}},function(e){e.O(0,[545,531,774,888,179],(function(){return t=8312,e(e.s=t);var t}));var t=e.O();_N_E=t}]);