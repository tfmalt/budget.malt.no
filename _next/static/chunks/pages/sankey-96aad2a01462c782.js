(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{5736:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sankey",function(){return n(6494)}])},7592:function(t,e,n){"use strict";n.d(e,{f:function(){return m}});var a=n(7568),r=n(603),o=n(4051),c=n.n(o),i=n(5893),s=n(7294),f=n(6887),u=n(8396),d=n(7357),l=n(5861),h={500:["#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688"],200:["#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#9fa8da","#90caf9","#81d4fa","80deea","#80cbc4"]},p={800:["#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#c62828","#ad1457","#6a1b9a","#4527a0","#283593","#1565c0","#0277bd","#00838f","#00695c"]},g=n(8100),m=function(t){var e=t.month,n=t.year,o=t.width,m=t.height,b=t.maxWidth,x=t.maxHeight,v=t.update,w=(0,g.D3)().getAccessTokenSilently,S=((0,u.Z)("(min-width:600px)"),(0,r.Z)(s.useState([["From","To","kr",{type:"string",role:"tooltip"}],["A","B",10,"foo"]]),2)),y=S[0],k=S[1],Z=(0,r.Z)(s.useState(new Date(0)),2),_=Z[0],N=Z[1];s.useEffect((function(){(0,a.Z)(c().mark((function t(){var a,r,o,i,s,f;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new Date,console.log("use effect called:",e,n,a.toJSON()),t.prev=2,t.next=5,w({audience:"https://api.malt.no/budget",scope:"read:streams"});case 5:return r=t.sent,o="".concat("https://api.malt.no","/budget/streams/").concat(n).concat(parseInt(e)<99?"/".concat(parseInt(e)+1):""),console.log("fetching url:",o),t.next=10,fetch(o,{headers:{Authorization:"Bearer ".concat(r)}});case 10:return i=t.sent,t.next=13,i.json();case 13:s=t.sent,console.log("got data:",s),N(new Date(s.timestamp)),f=[["From","To","Kr ",{type:"string",role:"tooltip"}]],s.values.forEach((function(t){f.push([t[0],t[1],t[2],'<div style="white-space: nowrap; padding: 8px;"><strong>'.concat(t[1],"</strong><br/>kr ").concat(t[2].toFixed(2),"</div>")])})),k(f),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(2),console.error(t.t0);case 24:case"end":return t.stop()}}),t,null,[[2,21]])})))()}),[e,n,v,w]);var j=new Date(parseInt(n),parseInt(e),12);return(0,i.jsxs)(d.Z,{children:[(0,i.jsx)(l.Z,{variant:"h2",children:parseInt(e)<99?j.toLocaleDateString("en-US",{month:"long",year:"numeric"}):"All of ".concat(n)}),(0,i.jsxs)(l.Z,{variant:"caption",children:["Sist oppdatert:"," ",_.toLocaleString("no-NO",{month:"long",year:"numeric",day:"numeric",hour:"numeric",minute:"numeric"})]}),(0,i.jsx)(f.ZP,{chartType:"Sankey",style:{width:o||400,height:m||400,maxWidth:b||"100%",maxHeight:x||"calc(100vw - 128px)"},options:{sankey:{iterations:256,link:{colors:h[200],colorMode:"gradient"},node:{colors:p[800],width:40,label:{color:"#444",fontName:"Roboto",fontSize:12}}},tooltip:{isHtml:!0,textStyle:{fontSize:12}}},data:y})]})}},6494:function(t,e,n){"use strict";n.r(e);var a=n(603),r=n(5893),o=n(8100),c=n(3156),i=n(7357),s=n(3321),f=n(7294),u=n(7592),d=n(8909);e.default=function(){var t=(0,o.D3)(),e=t.isAuthenticated,n=t.loginWithRedirect,l=new Date,h=(0,a.Z)(f.useState(l.getFullYear().toString()),2),p=h[0],g=(h[1],(0,a.Z)(f.useState(l.getMonth().toString()),2)),m=g[0],b=(g[1],(0,a.Z)(f.useState(l.toJSON()),2)),x=b[0],v=b[1];f.useEffect((function(){var t=setInterval((function(){v((function(){return(new Date).toJSON()}))}),36e5);return function(){return clearInterval(t)}}),[]);return(0,r.jsx)(c.Z,{disableGutters:!0,children:(0,r.jsx)(i.Z,{padding:2,children:e?(0,r.jsx)(u.f,{month:m,year:p,width:"100vw",maxHeight:"calc(100vh - 100px)",height:"calc(100vh - 100px)",update:x}):(0,r.jsx)(s.Z,{sx:{backgroundColor:d.r.palette.primary.main,background:"linear-gradient(90deg, ".concat(d.r.palette.primary.main," 20%, #4db6ac 100%)")},variant:"contained",size:"large",onClick:function(){n({connection:"google-oauth2",redirect_uri:"".concat("https://budget.malt.no","/sankey")})},children:"Sign in with Google"})})})}}},function(t){t.O(0,[359,774,888,179],(function(){return e=5736,t(t.s=e);var e}));var e=t.O();_N_E=e}]);